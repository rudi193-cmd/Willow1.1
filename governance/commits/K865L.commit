# Governance Proposal: Add Möbius ring support (ring, ring_override, get_ring)

**Proposer:** Free Fleet via Cerebras
**Date:** 2026-02-13T23:03:32.913113Z
**Type:** Code Enhancement
**Trust Level:** ENGINEER
**Commit ID:** K865L

## Summary
**Changes:**

The Git diff suggests that two new features were added to the `core/knowledge.py` file:

1. **Ring column and indexing**: A new column named `ring` was added to the `knowledge` table, along with an index named `idx_knowledge_ring`. This change likely provides an efficient way to query 

## Proposed Changes
**File:** core/knowledge.py

## Rationale
This change implements the requested modification with minimal disruption to existing functionality.

## Risk Assessment
- **Risk Level:** MEDIUM
- **Reversible:** YES
- **Dependencies:** None
- **Testing:** Manual verification required

## ΔE Impact
Expected ΔE: +0.05

## Implementation
```diff
diff --git a/core/knowledge.py b/core/knowledge.py
index a757ce9..2ea66c6 100644
--- a/core/knowledge.py
+++ b/core/knowledge.py
@@ -173,10 +173,74 @@ def init_db(username: str):
     except sqlite3.OperationalError:
         pass  # Column already exists
 
+    # --- Ring column (MÃ¶bius topology) ---
+    try:
+        cur.execute("ALTER TABLE knowledge ADD COLUMN ring TEXT DEFAULT 'bridge'")
+    except sqlite3.OperationalError:
+        pass  # Column already exists
+    cur.execute("CREATE INDEX IF NOT EXISTS idx_knowledge_ring ON knowledge(ring)")
+
+    # --- Ring override (human-set, protected â€” Aios Addendum Â§4) ---
+    try:
+        cur.execute("ALTER TABLE knowledge ADD COLUMN ring_override TEXT")
+    except sqlite3.OperationalError:
+        pass  # Column already exists
+
     conn.commit()
     conn.close()
 
 
+# =========================================================================
+# Ring assignment (MÃ¶bius topology)
+# =========================================================================
+
+SOURCE_CATEGORIES = {"governance", "charter", "hard_stop", "seed", "architecture"}
+CONTINUITY_CATEGORIES = {"handoff", "summary", "memory", "journal"}
+
+
+def _assign_ring(category: str, source_type: str, title: str) -> str:
+    """Derive ring position from existing category/source_type fields."""
+    if source_type == "conversation":
+        return "continuity"
+    cat_lower = (category or "").lower()
+    if cat_lower in SOURCE_CATEGORIES:
+        return "source"
+    title_upper = (title or "").upper()
+    if any(kw in title_upper for kw in ("GOVERNANCE", "CHARTER", "HARD_STOP", "SEED_PACKET")):
+        return "source"
+    if cat_lower in CONTINUITY_CATEGORIES:
+        return "continuity"
+    if any(kw in title_upper for kw in ("HANDOFF", "JOURNAL", "ENTRY_")):
+        return "continuity"
+    return "bridge"
+
+
+def get_ring(category: str, source_type: str, title: str, ring_override: Optional[str] = None) -> str:
+    """Resolve ring position. Human override takes precedence (Aios Addendum Â§4)."""
+    if ring_override:
+        return ring_override
+    return _assign_ring(category, source_type, title)
+
+
+def backfill_rings(username: str) -> int:
+    """Assign ring values to existing atoms. Respects ring_override. Returns count updated."""
+    init_db(username)
+    conn = _connect(username)
+    cur = conn.cursor()
+    rows = cur.execute(
+        "SELECT id, category, source_type, title, ring_override FROM knowledge"
+    ).fetchall()
+    updated = 0
+    for row_id, category, source_type, title, ring_override in rows:
+        ring = get_ring(category, source_type, title, ring_override)
+        cur.execute("UPDATE knowledge SET ring=? WHERE id=?", (ring, row_id))
+        updated += 1
+    conn.commit()
+    conn.close()
+    logging.info(f"KNOWLEDGE: Backfilled rings for {updated} atoms")
+    return updated
+
+
 # =========================================================================
 # Entity extraction
 # =========================================================================
@@ -300,11 +364,12 @@ def ingest_file_knowledge(
 
     # Insert knowledge atom
     now = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
+    ring = get_ring(category, "file", filename)
     cur.execute(
         """INSERT OR IGNORE INTO knowledge
-           (source_type, source_id, title, summary, content_snippet, category, created_at)
-           VALUES ('file', ?, ?, ?, ?, ?, ?)""",
-        (file_hash, filename, summary, snippet, category, now)
+           (source_type, source_id, title, summary, content_snippet, category, ring, created_at)
+           VALUES ('file', ?, ?, ?, ?, ?, ?, ?)""",
+        (file_hash, filename, summary, snippet, category, ring, now)
     )
     knowledge_id = cur.lastrowid
 

```

---

**Awaiting Human Ratification**

ΔΣ=42
